1.  Запишем общее уравнение теплопроводности:
    
        dT / dt = a**2 * [d2T / dr2 + d2T / dy2 + d2T / dz2],
        a**2 = lambda / (C_ro * ro), где

        t - время, с;
        x, y, z - декартовы координаты точки, м; 
        T - поле тепрератур T(x, y, z, t), К;
        lambda - коэффициент теплопроводности среды, Вт / (м * К);
        C_ro - удельная теплоемкость среды, Дж / (кг * К);
        ro - плотность среды, кг / (м**3).

2.  Для задачи с кольцом T(x, y, z, t) не зависит от z. Тогда общее
    уравнение теплопроводности будет иметь следующий вид:

        dT / dt = a**2 * [d2T / dr2 + d2T / dy2].

    Граничные условия по условию задачи должны удовлетворять
    закону Ньютона – Рихмана:

        lambda * dT / dn = a1 * [T1 - T],
        lambda * dT / dn = a2 * [T2 - T],

        dT / dn - производная по направлению n, которое есть внешняя нормаль к поверхности,
        внутри которой производится поиск поля T для t > 0.

3.  Для моделирования динамики поля T удобно перейти в полярную систему координат. Полярная система координат
    есть частный случай цилиндрической:

        d2F/dr2 + d2F/dy2 + d2F/dz2 = (1 / r) * (d / dr) * (r * dF / dr) +
                                    (1 / r**2) * (d2F / df2) + d2F/dz2,

        x = r * cos(f)
        y = r * sin(f).

    Так как задача с кольцом симметрична относитльно оси z и T не зависит от z, то
    T(x, y, z, t) = T(x, y, t) = T(r, f, t) = T(r, t), т.е. T есть функция только r и t.
    Тогда уравнение теплопроводности в полярной системе координат примет следующий вид:

        dT / dt = a**2 * (1 / r) * (d / dr) * (r * dT / dr),

        или

        dT / dt = a**2 * [(1 / r)  * (dT / dr) + d2T / dr2].

    Граничные условия перепешутся в следующий вид:

        lambda * dT / dn = a1 * [T1 - T],
        lambda * dT / dn = a2 * [T2 - T] ->

        [ dT / dn = dT / dr, dT / df == 0, dT / dz == 0 ] ->

        lambda * dT / dr = a1 * [T1 - T],
        lambda * dT / dr = a2 * [T2 - T].

    Начальные условия по условию задачи:

        T(r, 0) = T_0(r).

    Комбинируя вышеприведенные рассуждения приходим к следующим уравнениям:

        dT / dt = a**2 * [(1 / r)  * (dT / dr) + d2T / dr2],
        dT / dr = al1 * [T1 - T], al1 = a1 / lambda,
        dT / dr = al2 * [T2 - T], al2 = a2 / lambda,
        T(r, 0) = T_0(r).

4.  Для нахождения динамики поля T на промежутке времени {0, delta_t} аппроксимируем его равномерной сеткой:

        T(r, t) = T(r_i, t_j), i = 0, ..., N - 1, j = 0, ..., M - 1.
        r_i = R1 + i * dr, dr = (R2 - R1) / (N - 1),
        t_j = j * dt, dt = delta_t / (M - 1),

        и будем далее рассматривать динамические величины только в узлах данной сетки.
        Для краткости будем далее записывать T(r_i, t_j) как T(i, j).

    Производные аппроксимируем следующим образом:

        dT / dt = (d / dt) * T(i, j) = [T(i, j+1) - T(i, j)] / dt,
        dT / dr = (d / dr) * T(i, j) = [T(i+1, j) - T(i, j)] / dr, 
        d2T / dr2 = (d / dr) ((d / dr) * T(i, j)) =
        (d / dr) ([T(i+1, j) - T(i, j)] / dr) = [T(i+1, j) - 2 * T(i, j) + T(i-1, j)] / dr**2.

    Тогда уравнения, описывающие динамику температурного поля будут выглядеть так (неявная схема):

        [T(i, j+1) - T(i, j)] / dt = a**2 * {(1 / r_i) * ([T(i+1, j+1) - T(i, j+1)] / dr) +
                                             [T(i+1, j+1) - 2 * T(i, j+1) + T(i-1, j+1)] / dr**2},
        [T(1, j) - T(0, j)] / dr = - al1 * [T1 - T(0, j)],
        [T(N-1, j) - T(N-2, j)] / dr = al2 * [T2 - T(N-1, j)],
        T(i, 0) = T_0(i), i = 0, ..., N-1.

        преобразуем первое уравнение к следующему виду:

        Ai * T(i,j+1) + Bi * T(i+1,j+1) + C*T(i-1,j+1) = -T(i,j),

        где

        Ai = -1 - (dt * a**2) /(r_i * dr) - (2 * dt * a**2) /(dr**2),
        Bi = (dt * a**2) /(r_i * dr) + (dt * a**2) /(dr**2),
        C = (dt * a**2) /(dr**2).

        Воспользуемся методом прогонки:

        T(i,j+1) = Alpha(i) * T(i+1,j+1) + Beta(i).

        Тогда итеративный алгоритм решения будет выглядеть следующим образом:

        [
            Alpha(0) = 1 / (1 + al1 * dr)
            Beta(0) = al1 * dr * T1 / (1 + al1 * dr)

            Alpha(i) = - Bi / (Ai + C*Alpha(i-1))
            Beta(i) = - (T(i,j) + C*Beta(i-1)) / (Ai + C*Alpha(i-1))

            T(N-1, j+1) = (T2 * al2 * dr + T(N - 2, j)) / (1 +  al2 * dr)

            T(i, j+1) = Alpha(i) * T(i+1, j+1) + Beta(i)
        ]









    
    